int pin_piezo = 5;
int pin_pot = A0;
int pin_SW1 = 7;
int pin_SW2 = 8;

int AD_value = 0;
int i; 

int note[] = {
   330, 392, 440, 440, 0, 440, 494, 523, 523, 0, 
   523, 587, 494, 494, 0, 440, 392, 440, 0, 330, 
   392, 440, 440, 0, 440, 494, 523, 523, 0, 523, 
   587, 494, 494, 0, 440, 392, 440, 0, 330, 392, 
   440, 440, 0, 440, 523, 587, 587, 0, 587, 659, 
   698, 698, 0, 659, 587, 659, 440, 0, 440, 494, 
   523, 523, 0, 587, 659, 440, 0, 440, 523, 494, 
   494, 0, 523, 440, 494, 0, 440, 440, 440, 494, 
   523, 523, 0, 523, 587, 494, 494, 0, 440, 392, 
   440, 0, 330, 392, 440, 440, 0, 440, 494, 523, 
   523, 0, 523, 587, 494, 494, 0, 440, 392, 440, 
   0, 330, 392, 440, 440, 0, 440, 523, 587, 587, 
   0, 587, 659, 698, 698, 0, 659, 587, 659, 440, 
   0, 440, 494, 523, 523, 0, 587, 659, 440, 0, 
   440, 523, 494, 494, 0, 523, 440, 494, 0, 659, 
   0, 0, 698, 0, 0,  659, 659, 0, 784, 0, 659, 
   587, 0, 0, 587, 0, 0, 523, 0, 0,  494, 523, 0,
   494, 0, 440, 659, 0, 0, 698, 0, 0,659, 659, 0, 
   784, 0, 659, 587, 0, 0, 587, 0, 0, 523, 0, 0,
   494, 523, 0, 494, 0, 440
};

int duration[] = {         //trajanje svake note u ms
  125, 125, 250, 125, 125, 125, 125, 250, 125, 125,
  125, 125, 250, 125, 125, 125, 125, 375, 125, 125, 
  125, 250, 125, 125, 125, 125, 250, 125, 125, 125, 
  125, 250, 125, 125, 125, 125, 375, 125, 125, 125, 
  250, 125, 125, 125, 125, 250, 125, 125, 125, 125, 
  250, 125, 125, 125, 125, 125, 250, 125, 125, 125, 
  250, 125, 125, 250, 125, 250, 125, 125, 125, 250, 
  125, 125, 125, 125, 375, 375, 250, 125, 125, 125, 
  250, 125, 125, 125, 125, 250, 125, 125, 125, 125, 
  375, 125, 125, 125, 250, 125, 125, 125, 125, 250, 
  125, 125, 125, 125, 250, 125, 125, 125, 125, 375, 
  125, 125, 125, 250, 125, 125, 125, 125, 250, 125, 
  125, 125, 125, 250, 125, 125, 125, 125, 125, 250, 
  125, 125, 125, 250, 125, 125, 250, 125, 250, 125, 
  125, 125, 250, 125, 125, 125, 125, 375, 375, 250, 
  125, 375, 250, 125, 375, 125, 125, 125, 125, 125, 
  125, 125, 125, 375, 250, 125, 375, 250, 125, 375, 
  125, 125, 125, 125, 125, 500, 250, 125, 375, 250, 
  125, 375, 125, 125, 125, 125, 125, 125, 125, 125, 
  375, 250, 125, 375, 250, 125, 375, 125, 125, 125, 
  125, 125, 500
};

void pir(int nDelay) {
  for(i=0; i<203; i++){              //203 je ukupan broj nota u pjesmi
    int songspeed = 1.5;
    int wait = duration[i] * songspeed + nDelay;
    tone(pin_piezo,note[i],wait);         
    delay(wait);
  }
}


int broj_tonova = 22;

int tonovi[] = { 
  262, 294, 330, 350, 392, 440, 
  494, 523, 587, 659, 698, 784, 
  880, 988, 1047, 1175, 1319, 
  1397, 1568, 1760, 1976, 2093 
};

void setup() {
  pinMode(pin_pot, INPUT);
  pinMode(pin_piezo, OUTPUT);
  pinMode(pin_SW1, INPUT_PULLUP);
  pinMode(pin_SW2, INPUT_PULLUP);

  Serial.begin(9600);
}

void loop() {
  AD_value = analogRead(pin_pot);  // vrijednost potenciometra
  int nDelay = map(AD_value, 0, 1023, 0, 1000);
  Serial.print("\nDelay:\t");
  Serial.print(nDelay);

  if(digitalRead(pin_SW1) == LOW){  // uključena 1. sklopka
    for(i=0; i<broj_tonova; i++){
      tone(pin_piezo, tonovi[i]);
      delay(nDelay);
    }
  }
  else{
    noTone(pin_piezo);
  }

  if(digitalRead(pin_SW2) == LOW){  // uključena 2. sklopka
    pir(nDelay);
  }
  else{
    noTone(pin_piezo);
  }
}
